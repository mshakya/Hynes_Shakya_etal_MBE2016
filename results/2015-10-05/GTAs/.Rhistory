strain_name <- tail(given_name_list, length(l) - 2)
formatted <- paste(given_name_list[1], "italic('", name, "')", paste(strain_name, collapse=" "))}
else {
formatted <- paste("italic('", name, "')")
}
}
return(formatted)
}
change_to_italic('migun_shakuya')
change_to_italic <- function(given_name){
# given a genus and species name, function outputs an expression to be
# parsed for italics of genus and species name and also account for
# candidatus
given_name_list <- unlist(strsplit(given_name, split="_"))
if (given_name_list[1] == 'Candidatus'){
name <- paste(given_name_list[2], given_name_list[3], sep=" ")
if (length(given_name_list) > 3){
strain_name <- tail(given_name_list, length(l) - 3)
formatted <- paste(given_name_list[1], "italic('", name, "')", paste(strain_name, collapse=" "), sep= "")
} else{
formatted <- paste(given_name_list[1], "italic('", name, "')")
}
} else {
name <- paste(given_name_list[1], given_name_list[2], sep=" ")
if (length(given_name_list) > 2){
strain_name <- tail(given_name_list, length(l) - 2)
formatted <- paste(given_name_list[1], "italic('", name, "')", paste(strain_name, collapse=" "), sep="")}
else {
formatted <- paste("italic('", name, "')")
}
}
return(formatted)
}
change_to_italic('migun_shakuya')
as.character('1NES1')
x<-list(a<-c('k','l'), b<-('a'))
x
x<-list(a=('k','l'), b=('a'))
x
x<-list(a=('k','l'), 'b'=('a'))
x<-list(a=c('k','l'), 'b'=('a'))
x
x$a
names(x)
names(x)[1]
names(x)[1] <- 'migun'
x
rep_taxa = c("Brucella melitensis M28 chromosome chromosome 1",
"Agrobacterium vitis S4 chromosome 1",
"Rhodopseudomonas palustris DXâˆ’1 chromosome",
"Starkeya novella DSM 506 chromosome",
"Hyphomicrobium denitrificans ATCC 51888 chromosome",
# "Phaeobacter gallaeciensis DSM 17395 chromosome",
"Jannaschia sp. CCS1 chromosome",
"Rhodobacter capsulatus SB 1003 chromosome",
# "Caulobacter sp. K31 chromosome",
# "Caulobacter crescentus NA1000",
"Caulobacter segnis ATCC 21756 chromosome",
"Parvularcula bermudensis HTCC2503 chromosome",
# "Erythrobacter litoralis HTCC2594 chromosome",
"Sphingobium chlorophenolicum L-1 chromosome 1")
rep_taxa
lapply(rep_taxa, function(x) strsplit(x, split="chromosome")[1])
<- unlist(lapply(rep_taxa, function(x) strsplit(x, split="chromosome")[1]))
k<- unlist(lapply(rep_taxa, function(x) strsplit(x, split="chromosome")[1]))
k
k<- unlist(lapply(rep_taxa, function(x) strsplit(x, split="chromosome")[[1]]))
k
rep_taxa
strsplit("Brucella melitensis M28 chromosome chromosome 1", split="chromosome")
k<- unlist(lapply(rep_taxa, function(x) strsplit(x, split="chromosome")[[1]][1]))
k
k<- unlist(lapply(rep_taxa, function(x) strsplit(x, split=" chromosome")[[1]][1]))
k
a <- c(rep("A", 3), rep("B", 3), rep("C",2))
b <- c(1,1,2,4,1,1,2,2)
df <-data.frame(a,b)
df
duplicated(df)
grepl("chr", "chromo")
Title = c("Brucella ceti TE10759-12 chromosome 1",
"Brucella ceti TE28753-12 chromosome 1",
"Brucella melitensis NI chromosome chromosome I",
"Brucella melitensis M5-90 chromosome chromosome I",
"Brucella melitensis M28 chromosome chromosome 1",
"Brucella suis VBI22 chromosome I",
"Brucella abortus A13334 chromosome 1",
"Brucella canis ATCC 23365 chromosome I",
"Brucella suis 1330 chromosome I",
"Brucella abortus bv. 1 str. 9-941 chromosome I",
"Brucella melitensis biovar Abortus 2308 chromosome I",
"Brucella ovis ATCC 25840 chromosome I",
"Brucella suis ATCC 23445 chromosome I",
"Brucella abortus S19 chromosome 1",
"Brucella melitensis ATCC 23457 chromosome I",
"Brucella microti CCM 4915 chromosome 1",
"Brucella canis HSK A52141 chromosome 1",
"Brucella pinnipedialis B2/94 chromosome 1",
"Brucella melitensis bv. 1 str. 16M chromosome I",
"Rhizobium sp. IRBG74 circular chromosome",
"Pelagibacterium halotolerans B2 chromosome",
"Agrobacterium fabrum str. C58 chromosome circular",
"Agrobacterium sp. H13-3 chromosome",
"Agrobacterium vitis S4 chromosome 1",
"Rhodopseudomonas palustris TIE-1 chromosome",
"Rhodopseudomonas palustris CGA009 chromosome",
"Rhodopseudomonas palustris DX-1 chromosome",
"Rhodopseudomonas palustris BisA53 chromosome",
"Rhodopseudomonas palustris BisB18 chromosome",
"Rhodopseudomonas palustris BisB5 chromosome",
"Rhodopseudomonas palustris HaA2 chromosome",
"Nitrobacter winogradskyi Nb-255 chromosome",
"Nitrobacter hamburgensis X14 chromosome",
"Oligotropha carboxidovorans OM5 chromosome",
"Oligotropha carboxidovorans OM4 chromosome",
"Methylocystis sp. SC2",
"Hyphomicrobium denitrificans 1NES1",
"Hyphomicrobium denitrificans ATCC 51888 chromosome",
"Hyphomicrobium sp. MC1",
"Hyphomicrobium nitrativorans NL23",
"Parvibaculum lavamentivorans DS-1 chromosome",
"Methylobacterium extorquens DM4",
"Methylobacterium extorquens AM1",
"Methylobacterium extorquens CM4 chromosome",
"Methylobacterium extorquens PA1 chromosome",
"Methylobacterium populi BJ001 chromosome",
"Methylobacterium radiotolerans JCM 2831 chromosome",
"Methylobacterium nodulans ORS 2060 chromosome",
"Methylobacterium sp. 4-46 chromosome",
"Starkeya novella DSM 506 chromosome",
"Xanthobacter autotrophicus Py2 chromosome",
"Azorhizobium caulinodans ORS 571 chromosome",
"Pseudovibrio sp. FO-BEG1 chromosome",
"Polymorphum gilvum SL003B-26A1 chromosome",
"Caulobacter sp. K31 chromosome",
"Caulobacter segnis ATCC 21756 chromosome",
"Caulobacter crescentus NA1000",
"Caulobacter crescentus CB15 chromosome",
"Brevundimonas subvibrioides ATCC 15264 chromosome",
"Asticcacaulis excentricus CB 48 chromosome 1",
"Hirschia baltica ATCC 49814 chromosome",
"Maricaulis maris MCS10 chromosome",
"Parvularcula bermudensis HTCC2503 chromosome",
"Octadecabacter arcticus 238",
"Octadecabacter antarcticus 307",
"Jannaschia sp. CCS1 chromosome",
"Roseobacter litoralis Och 149 chromosome",
"Roseobacter denitrificans OCh 114 chromosome",
"Dinoroseobacter shibae DFL 12 chromosome",
"Phaeobacter gallaeciensis 2.10 chromosome",
"Phaeobacter gallaeciensis DSM 17395 chromosome",
"Phaeobacter gallaeciensis DSM 26640",
"Ruegeria sp. TM1040 chromosome",
"Leisingera methylohalidivorans DSM 14336 strain MB2",
"Ruegeria pomeroyi DSS-3",
"Rhodobacter sphaeroides KD131 chromosome 1",
"Rhodobacter sphaeroides ATCC 17029 chromosome 1",
"Rhodobacter sphaeroides 2.4.1 chromosome 1",
"Rhodobacter sphaeroides ATCC 17025 chromosome",
"Paracoccus aminophilus JCM 7686",
"Paracoccus denitrificans PD1222 chromosome 2",
"Rhodobacter capsulatus SB 1003 chromosome",
"Ketogulonicigenium vulgare Y25 chromosome",
"Ketogulonigenium vulgarum WSH-001 chromosome",
"Sphingobium chlorophenolicum L-1 chromosome 1",
"Sphingobium japonicum UT26S chromosome 1",
"Sphingobium sp. SYK-6 chromosome",
"Sphingopyxis alaskensis RB2256 chromosome",
"Sphingomonas sp. MM-1",
"Novosphingobium sp. PP1Y chromosome",
"Novosphingobium aromaticivorans DSM 12444 chromosome",
"Erythrobacter litoralis HTCC2594 chromosome"
)
print(unlist(lapply(Title,
function(x) if (grepl('chromosomse', x)) {strsplit(x, split=" chromosome")[[1]][1]} else {x})))
print(unlist(lapply(Title,
function(x) if (grepl('chromosome', x)) {strsplit(x, split=" chromosome")[[1]][1]} else {x})))
t.test(c(1,2))
t.test(c(1,2), c(2))
t.test(c(1,2), c(2,3))
ggtree(rtree(5))
ggtree(rtree(5)) + scale_x_continuous(xlim=c(-500,500))
max(cophenetic.phylo(rtree(5)))
library(ape)
max(cophenetic.phylo(rtree(5)))
ggtree(rtree(5)) + scale_x_continuous(xlim=c(-500,500))
multi_tree
rts <- sapply(multi_tree, function(x) max(cophenetic.phylo(x)))
rts
maxrts(rts)
maxrts <- max(rts)
lim <- cbind(rts - maxrts, rts)
lim
rts
ggtree(multi_tree[[1]]) + scale_linetype_continuous()
ggtree(multi_tree[[1]]) + scale_shape_manual(4)
ggtree(multi_tree[[1]]) + scale_shape_manual(2)
ggtree(multi_tree[[1]]) + + coord_cartesian(ylim=c(0,1))
ggtree(multi_tree[[1]]) + coord_cartesian(ylim=c(0,1))
ggtree(multi_tree[[1]]) + coord_cartesian(ylim=c(5,6))
ggtree(multi_tree[[1]]) + coord_cartesian(ylim=c(-5,6))
ggtree(multi_tree[[1]]) + coord_cartesian(xlim=c(-5,6))
lim[1,]
lim[1,]
ggtree(multi_tree[[1]]) + coord_cartesian(xlim=c(-5.5,6.7), ylim=c(-5.5,6.7))
ggtree(multi_tree[[1]]) + coord_cartesian(xlim=c(-5.5,6.7), ylim=c(-5.5,6.7))
ggtree(multi_tree[[1]]) + scale_x_continuous(xlim=c(-5.5,6.7), ylim=c(-5.5,6.7))
ggtree(multi_tree[[1]]) + coord_fixed()
ggtree(multi_tree[[1]]) + coord_fixed(1,1)
?coord_fixed
ggtree(multi_tree[[1]]) + coord_fixed(1)
?coord_fixed
ggtree(multi_tree[[1]]) + coord_fixed(c(-5.5, 6.7), ylim = c(-5.5, 6.7))
ggtree(multi_tree[[1]]) + coord_fixed(xlim=c(-5.5, 6.7), ylim = c(-5.5, 6.7))
ggtree(multi_tree[[1]]) + coord_fixed(1,xlim=c(-5.5, 6.7), ylim = c(-5.5, 6.7))
?coord_cartesian
?coord_fixed
p <- ggplot(mtcars, aes(mpg, wt)) + geom_point()
p
p <- ggplot(mtcars, aes(mpg, wt)) + geom_point(ratio=1)
p + coord_fixed(ratio = 1)
p + coord_fixed(ratio = 1/2)
ggtree(multi_tree[[1]]) + coord_fixed(xlim=c(-5.5, 6.7), ylim = c(-5.5, 6.7))
ggtree(multi_tree[[1]]) + coord_fixed(xlim=c(-5.5, 6.7), ylim = c(-5.5, 6.7))
a<-ggtree(multi_tree[[1]]) + coord_fixed(xlim=c(-5.5, 6.7), ylim = c(-5.5, 6.7))
a<-ggtree(multi_tree[[b]]) + coord_fixed(xlim=c(-5.5, 6.7), ylim = c(-5.5, 6.7))
b<-ggtree(multi_tree[[2]]) + coord_fixed(xlim=c(-5.5, 6.7), ylim = c(-5.5, 6.7))
b
p = qplot(1, 1)
grid.arrange(p, p, respect=TRUE) # both viewports are square
grid.arrange(p, p, respect=TRUE, heights=c(1,2)) # relative heights
p1 = p + theme(aspect.ratio=3)
grid.arrange(p,p1, respect=TRUE) # one is square, the other thinner
p <- ggplot(mtcars, aes(mpg, wt)) + geom_point(ratio=1)
p <- ggplot(mtcars, aes(mpg, wt)) + geom_point()
p
p + coord_fixed(xlim = c(10,15))
p <- ggplot(mtcars, aes(mpg, wt)) + geom_point()
p
p + coord_fixed(xlim = c(0,40))
?coord_fixed
lim[1,]
?ggtree
tr <- rtree(10)
ggtree(tr)
ggtree(tr, yscale=1)
ggtree(tr, yscale=3)
ggtree(tr, yscale=1)
tr <- rtree(10)
ggtree(tr)
ggtree(tr, yscale=1)
ggtree(tr, yscale_mapping = 1)
ggtree(tr, yscale_mapping = 2)
ggtree(tr, yscale_mapping = 20)
colorBranch <- function(phy, focus, col=rainbow, ...){
# a function that colors the branches
# colors branches specified in focus
# with rainbow color palette
if (!is.list(focus))
focus <- list(focus)
n <- length(focus)
if (is.function(col)) {
col <- col(n) }
else {col <- col}
#assign color to each branch
colo <- rep("black", dim(phy$edge)[1])
#replace colors based on the given branch
for (i in 1:n) colo[which.edge(phy, focus[[i]])] <- col[i]
#b_times <- branching.times(phy)[1]
plot.phylo(phy, edge.color=colo, ...)
#dev.off()
}
pdf("~/Desktop/GTA/LangPaper/results/2015-11-16/GTA_tree_ML.pdf",50,55)
oma.saved <- par("oma")
par(oma = rep.int(0, 4))
par(oma = oma.saved)
o.par <- par(mar = rep.int(0, 4))
on.exit(par(o.par))
m<-rbind(c(26:30),c(1:5),c(1:5), c(1:5), c(1:5),
c(31:35),c(6:10),c(6:10),c(6:10),c(6:10),
c(36:40),c(11:15),c(11:15),c(11:15),c(11:15),
c(41:45),c(16:20),c(16:20),c(16:20),c(16:20),
c(46:50),c(21:25),c(21:25),c(21:25),c(21:25))
layout(m)
#coloring based on GTAs, rhodobacterales-virus, alpha-virus
##################read trees ##################
#1. rcc171
setwd("~/Desktop/GTA/LangPaper/results/2015-12-03/GTAs/")
rcc171<-read.tree("rcc171_dir/rcc171_viral_LC_un_.tre")
#2. rcc555
#setwd("~/Desktop/GTA/LangPaper/results/2015-10-05/GTAs/")
# decided not to use the new one (2015-12-03), as the only difference
# compared to 2015-10-05 is one taxa
# and even the shape looks the same too
#setwd("~/Desktop/GTA/LangPaper/results/2015-12-03/GTAs/")
rcc555<-read.tree("endo_dir/endo_viral_LC_un_.tre")
#rcc555<-read.tree("endo_dir/endo_LC_viral_rhodo_.tre")
#3.rcc556
setwd("~/Desktop/GTA/LangPaper/results/2015-09-30")
rcc556<-read.tree("rspr_/holin_blastp_psiblast_rhodo_only_bestPara.tre")
#4. rcc1079
setwd("~/Desktop/GTA/LangPaper/results/2015-12-03/GTAs/")
TF1<-read.tree("orfgTF1_dir/orfgTF1_viral_LC_un_.tre")
#5. rcc1080
#no viral homologs
TF2<-read.tree("orfgTF2_dir/orfgTF2_viral_LC_un_.tre")
#6. orfg1
setwd("~/Desktop/GTA/LangPaper/results/2015-09-30")
#no viral homologs
orfg1 <- read.tree("rspr_/orfg1_blastp_psiblast_rhodo_only_bestPara.tre")
#7. orfg2
setwd("~/Desktop/GTA/LangPaper/results/2015-10-03/GTAs/")
orfg2<-read.tree("orfg2_dir/orfg2_LC_viral_rhodo_.tre")
#8. orfg3
orfg3 <- read.tree("orfg3_dir/orfg3_LC_viral_rhodo_.tre")
#9 orfg3.5
#no viral homolog
setwd("~/Desktop/GTA/LangPaper/results/2015-09-30")
orfg3.5 <- read.tree("rspr_/orfg3_5_blastp_psiblast_rhodo_only_bestPara.tre")
#10. orfg4
setwd("~/Desktop/GTA/LangPaper/results/2015-10-03/GTAs/")
orfg4 <- read.tree("orfg4_dir/orfg4_LC_viral_rhodo_.tre")
#11. orfg5
orfg5 <- read.tree("orfg5_dir/orfg5_LC_viral_rhodo_.tre")
#12. orfg6
orfg6 <- read.tree("orfg6_dir/orfg6_LC_viral_rhodo_.tre")
#13. orfg7
orfg7 <- read.tree("orfg7_dir/orfg7_LC_viral_rhodo_.tre")
#14. orfg8
orfg8 <- read.tree("orfg8_dir/orfg8_LC_viral_rhodo_.tre")
#16. orfg9
setwd("~/Desktop/GTA/LangPaper/results/2015-09-30")
#no viral homologs
orfg9 <- read.tree("rspr_/orfg9_blastp_psiblast_rhodo_only_bestPara.tre")
#17. orfg10
#no viral homologs
orfg10 <- read.tree("rspr_/orfg10_blastp_psiblast_rhodo_only_bestPara.tre")
#18. orfg10.1
#no viral homologs
orfg10.1 <- read.tree("rspr_/orfg10_5_blastp_psiblast_rhodo_only_bestPara.tre")
#19. orfg11
setwd("~/Desktop/GTA/LangPaper/results/2015-10-03/GTAs/")
orfg11 <- read.tree("orfg11_dir/orfg11_LC_viral_rhodo_.tre")
#20. orfg12
orfg12 <- read.tree("orfg12_dir/orfg12_LC_viral_rhodo_.tre")
#19. orfg13
orfg13 <- read.tree("orfg13_dir/orfg13_LC_viral_rhodo_.tre")
#20. orfg14
orfg14 <- read.tree("orfg14_dir/orfg14_LC_viral_rhodo_.tre")
#21. orfg15
orfg15 <- read.tree("orfg15_dir/orfg15_LC_viral_rhodo_.tre")
#22. rcc1865
setwd("~/Desktop/GTA/LangPaper/results/2015-10-05/GTAs/")
rcc1865<-read.tree("rcc1865_dir/rcc1865_LC_viral_rhodo_.tre")
#23. rcc1866
rcc1866<-read.tree("rcc1866_dir/rcc1866_LC_viral_rhodo_.tre")
####################calculate minimum max length####################
multi_tree <- list(rcc171, rcc555, rcc556, TF1, TF2, orfg1, orfg2, orfg3,
orfg3.5, orfg4, orfg5, orfg6, orfg7, orfg8, orfg9, orfg10,
orfg10.1, orfg11, orfg12, orfg13, orfg14, orfg15,
rcc1865, rcc1866)
rts <- sapply(multi_tree, function(x) max(cophenetic.phylo(x)))
maxrts <- max(rts)
lim <- cbind(rts - maxrts, rts)
###################plot trees#########################
#1 rcc171
colorBranch(rcc171, list(c(28:45, 50:58),c(25:26,46:49,59,62), c()),
col=c("#d95f02", "#377eb8", "purple3"),
type="unrooted", show.tip.label=FALSE,
x.lim=lim[1,], y.lim=lim[1,])
add.scale.bar(0,0,0.5, lwd=3, cex=4)
box()
dev.off()
colorBranch(TF1, list(c(1:5,7:8,10,12:17), c(6,11), c(9)),
col=c("#d95f02", "#377eb8", "purple3"),
type="unrooted", show.tip.label=FALSE,
x.lim=lim[4,], y.lim=lim[4,])
add.scale.bar(0,0,0.5, lwd=3, cex=4)
box()
x.lim=lim[4,]
lim[4,]
lim[4,][1]
lim[4,][2]
str(lim[4,])
?plot
?plot
colorBranch(TF1, list(c(1:5,7:8,10,12:17), c(6,11), c(9)),
col=c("#d95f02", "#377eb8", "purple3"),
type="unrooted", show.tip.label=FALSE,
xlim=lim[4,], ylim=lim[4,])
add.scale.bar(0,0,0.5, lwd=3, cex=4)
box()
lim
?plot
?geom_treescale
ggtree()
ggtree(rtree(1))
ggtree(rtree(2))
ggtree(rtree(2),col="white")
ggtree(rtree(2))
ggtree(rtree(2)) + geom_blank()
?geom_blank
?cophenetic.phylo
cophenetic.phylo(multi_tree[[1]])
<-max(cophenetic.phylo(multi_tree[[1]]))
max(cophenetic.phylo(multi_tree[[1]]))
?read.ra
raxml_file <- system.file("extdata/RAxML", "RAxML_bipartitionsBranchLabels.H3", package="ggtree")
raxml <- read.raxml(raxml_file)
str(raxml)
slot(raxml)
slot(raxml, phylo)
slot(raxml, edge)
slot(raxml, 'file')
slot(raxml, 'phylo')
slot(raxml, 'phylo')$tip.label <- 'a'
slot(raxml, 'phylo')
raxml
raxml_file <- system.file("extdata/RAxML", "RAxML_bipartitionsBranchLabels.H3", package="ggtree")
raxml <- read.raxml(raxml_file)
raxml
ggtree(raxml)
ggtree(raxml) + geom_tiplab()
slot(raxml, 'phylo')$tip.label <- rep('a', 64)
ggtree(raxml) + geom_tiplab()
raxml_file <- system.file("extdata/RAxML", "RAxML_bipartitionsBranchLabels.H3", package="ggtree")
raxml <- read.raxml(raxml_file)
ggtree(raxml) + geom_tiplab()
root(raxml, c("A_Hokkaido_M1_2014_H3N2_2014"))
?root
root(slot(raxml, phylo), c("A_Hokkaido_M1_2014_H3N2_2014"))
slot(raxml, phylo)
root(slot(raxml, 'phylo'), c("A_Hokkaido_M1_2014_H3N2_2014"))
a<-root(slot(raxml, 'phylo'), c("A_Hokkaido_M1_2014_H3N2_2014"))
ggtree(a) + geom_tiplab()
a<-root(slot(raxml, 'phylo'), c("FJ532080_A_California_09_2008_H3N2_2008"))
ggtree(a) + geom_tiplab()
a
slot(raxml,'phylo') <- root(slot(raxml, 'phylo'), c("FJ532080_A_California_09_2008_H3N2_2008"))
ggtree(raxml)
ggtree(raxml) + geom_tiplab()
raxml
slot(tree,'phylo') <- root(slot(tree, 'phylo'), c("Methylobacterium_nodulans_ORS_2060"))
raxml_file <- system.file("extdata/RAxML", "RAxML_bipartitionsBranchLabels.H3", package="ggtree")
raxml <- read.raxml(raxml_file)
slot(raxml,'phylo') <- root(slot(raxml, 'phylo'), c("Methylobacterium_nodulans_ORS_2060"))
slot(raxml,'phylo') <- root(slot(raxml, 'phylo'), c("FJ532080_A_California_09_2008_H3N2_2008"))
raxml
rererr
raxml
raxml_file <- system.file("extdata/RAxML", "RAxML_bipartitionsBranchLabels.H3", package="ggtree")
raxml <- read.raxml(raxml_file)
raxml
slot(raxml,'phylo') <- root(slot(raxml, 'phylo'), c("FJ532080_A_California_09_2008_H3N2_2008"))
x=list(rtree(10), rtree(20), rtree(30))
class(x) = "multiPhylo"
ggtree(x) + facet_wrap(~.id, scales="fixed")
?ggtree
ggtree(rtree10)
ggtree(rtree(10))
ggtree(rtree(10)) + geom_tiplab()
ggtree(rtree(10)) + geom_tiplab()
p1 <- ggtree(rtree(10)) + geom_tiplab()
p2 <- p1 %>% collapse(node==3)
p1
p1 + geom_text2(aes(subset=!isTip, label=node), hjust=-.3)
p1 <- ggtree(rtree(10)) + geom_tiplab()
p2 <- p1 %>% collapse(node==19)
p1 <- ggtree(rtree(10)) + geom_tiplab()
p2 <- p1 %>% collapse(node==18)
set.seed(4567)
p1 <- ggtree(rtree(10)) + geom_tiplab()
p2 <- p1 %>% collapse(node==3)
p1
p1 + geom_text2(aes(subset=!isTip, label=node), hjust=-.3)
p1 <- ggtree(rtree(10)) + geom_tiplab()
p2 <- p1 %>% collapse(node==3)
p1 %>% collapse(node==3)
p2
p1 %>% collapse(node==3)
p1
p1 + geom_text2(aes(subset=!isTip, label=node), hjust=-.3)
p1 %>% collapse(node==17)
p1 %>% collapse(node==12)
p1 %>% collapse(node=='12')
rtree(10)
p1 %>% collapse(node==16)
p1
p1 %>% collapse(node==16)
p1 %>% collapse(node==12)
p1 %<% collapse(node==12)
ggtree(tree) %>% collapse(node=21)
nwk <- system.file("extdata", "sample.nwk", package="ggtree")
tree <- read.tree(nwk)
p1<-ggtree(tree) + geom_text2(aes(subset=!isTip, label=node), hjust=-.3) + geom_tiplab()
p1
p2 <- ggtree(read.tree(nwk)) %>% groupClade(node=21) + aes(color=group, linetype=group)
ggtree(list(p1,p2))
multiplot(p1,p2)
multiplot(p1,p2,cols=2)
raxml_file <- system.file("extdata/RAxML", "RAxML_bipartitionsBranchLabels.H3", package="ggtree")
raxml <- read.raxml(raxml_file)
ggtree(raxml) + geom_label(aes(label=bootstrap, fill=bootstrap)) + geom_tiplab()
p1<-ggtree(raxml) + geom_label(aes(label=bootstrap, fill=bootstrap)) + geom_tiplab()
p2 <- ggtree(read.tree(nwk)) %>% groupClade(node=21) + aes(color=group, linetype=group)
multiplot(p1,p2)
multiplot(p1,p2, cols=2)
p1<-ggtree(tree) + geom_text2(aes(subset=!isTip, label=node), hjust=-.3) + geom_tiplab() + geom_treescale()
p2 <- ggtree(read.tree(nwk)) %>% groupClade(node=21) + aes(color=group, linetype=group) + geom_treescale()
multiplot(p1,p2, cols=2)
p1<-ggtree(raxml) + geom_label(aes(label=bootstrap, fill=bootstrap)) + geom_tiplab() + geom_treescale()
multiplot(p1,p2, cols=2)
